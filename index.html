<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Report: Agri-Connect - AI Agricultural Advisory System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fcfdfc; 
        }
        .section-card {
            background-color: white;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            padding: 2rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        h1, h2, h3 {
            font-weight: 700;
            color: #14532d; /* Tailwind's green-900 */
        }
        h2 {
            font-size: 1.75rem;
            line-height: 2.25rem;
            border-bottom: 2px solid #22c55e; /* Tailwind's green-500 */
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .kpi-card {
            background: #f0fdf4; /* green-50 */
            border-left: 5px solid #22c55e; /* green-500 */
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: center;
        }
        .feature-icon {
            width: 4rem;
            height: 4rem;
            padding: 0.75rem;
            border-radius: 9999px;
            background-color: #dcfce7; /* green-100 */
            color: #166534; /* green-800 */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }
        .hist-kpi-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgb(0 0 0 / 0.08);
            text-align: center;
        }
    </style>
</head>
<body class="text-gray-800 antialiased">

    <!-- Header Section -->
    <header class="bg-green-800 text-white shadow-lg">
        <div class="container mx-auto px-6 py-8">
            <h1 class="text-4xl md:text-5xl font-bold leading-tight">Agri-Connect</h1>
            <p class="text-lg md:text-xl mt-2 text-green-200">An AI-Powered Advisory System for Modern Agriculture</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-12">

        <!-- Executive Summary -->
        <section id="summary" class="section-card">
            <h2 class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                Executive Summary
            </h2>
            <div class="md:flex md:space-x-8 items-center">
                <div class="md:w-2/3">
                    <p class="mb-4">Originally conceived for the agricultural landscape of Kerala, the Agri-Connect project has been adapted and is now being launched with real-time data from over 10,000 farmer interactions in Rajasthan, addressing their most immediate and pressing challenges. Our data reveals two critical pain points: determining optimal crop sowing times according to specific soil types and navigating opaque government procurement processes where middlemen diminish profits.</p>
                    <p class="mb-4">This report details "Agri-Connect," a multilingual AI-powered advisory system designed to bridge these gaps. Supporting Hindi, Malayalam, and English, the platform empowers farmers to receive instant, context-aware answers to complex cultivation and commerce questions via text, voice, or image.</p>
                    <p>By leveraging fine-tuned LLMs, the system provides soil-specific crop calendars and real-time market intelligence, aiming to automate first-level support, ensure fair market access, and ultimately boost farmer livelihoods.</p>
                </div>
                <div class="md:w-1/3 mt-6 md:mt-0">
                    <img src="https://images.pexels.com/photos/10399125/pexels-photo-10399125.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="Indian farmer using a smartphone in a paddy field" class="rounded-lg shadow-md w-full h-auto object-cover">
                    <p class="text-center text-sm text-gray-500 mt-2">Empowering Rajasthan's farmers with technology.</p>
                </div>
            </div>
        </section>

        <!-- The Challenge: Data & Analytics -->
        <section id="challenge" class="section-card">
            <h2>The Challenge: A Tale of Two Timelines</h2>
            <p class="mb-6">To understand the need for Agri-Connect, we must analyze both the historical, systemic issues and the immediate, data-driven problems faced by farmers in Rajasthan today.</p>
            
            <h3 class="text-xl font-semibold text-green-800 mb-4">Historical Context: The Persistent Information Gap</h3>
            <p class="mb-6 text-gray-600">For decades, farmers have operated with significant disadvantages. Traditional support systems are slow and overwhelmed, leading to quantifiable losses. The following metrics represent the long-standing challenges that our project aims to solve permanently:</p>
            <div class="grid md:grid-cols-3 gap-6 mb-10">
                <div class="hist-kpi-card">
                    <div class="text-5xl font-bold text-red-600">78%</div>
                    <p class="font-semibold text-gray-700 mt-2">Of farmers lack access to timely, expert advice for critical issues like pest control.</p>
                </div>
                <div class="hist-kpi-card">
                    <div class="text-5xl font-bold text-yellow-600">12+</div>
                    <p class="font-semibold text-gray-700 mt-2">Hours often wasted by farmers waiting for responses from overburdened agri officers.</p>
                </div>
                <div class="hist-kpi-card">
                    <div class="text-5xl font-bold text-red-700">45%</div>
                    <p class="font-semibold text-gray-700 mt-2">Potential crop loss due to delayed information on weather and diseases.</p>
                </div>
            </div>

            <h3 class="text-xl font-semibold text-green-800 mb-4 mt-8">Current Needs: Real-Time Data from Rajasthan</h3>
            <p class="mb-6 text-gray-600">Our direct interactions with over 10,000 farmers in Rajasthan pinpoint their modern challenges. The data below shows where they need the most help right now.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="kpi-card">
                    <h3 class="text-lg font-semibold text-green-800 mb-2">Common Farmer Queries (Rajasthan Data)</h3>
                    <p class="text-sm mb-4">Distribution based on analysis of 10,000+ real-time farmer interactions.</p>
                    <canvas id="queryPieChart"></canvas>
                </div>
                <div class="kpi-card">
                    <h3 class="text-lg font-semibold text-green-800 mb-2">The Financial Cost of Information Delay</h3>
                     <p class="text-sm mb-4">Analysis of potential daily income loss per hectare from waiting for critical advice.</p>
                    <canvas id="costOfDelayChart"></canvas>
                </div>
            </div>
        </section>

        <!-- The Solution: Core Features -->
        <section id="solution" class="section-card">
            <h2>The Solution: An AI-Powered Digital Assistant</h2>
            <p class="mb-8">"Agri-Connect" is designed with a farmer-first approach. Its core features are built to address both historical and current challenges with a multilingual, data-rich platform.</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 text-center">
                <!-- Feature 1: Multilingual Interface -->
                <div class="p-6 bg-gray-50 rounded-lg">
                    <div class="feature-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10-5-10M17 3l-5 10 5 10" />
                        </svg>
                    </div>
                    <h3 class="font-semibold text-lg text-green-800">Multilingual Interface</h3>
                    <p class="text-sm mt-1">Full support for Hindi, Malayalam, and English, ensuring accessibility for all users.</p>
                </div>
                 <!-- Feature 2: Natural Language -->
                <div class="p-6 bg-gray-50 rounded-lg">
                    <div class="feature-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18.75a6 6 0 006-6v-1.5a6 6 0 00-6-6v-1.5a6 6 0 00-6 6v1.5a6 6 0 006 6zM12 18.75a6 6 0 01-6-6v-1.5a6 6 0 016-6v-1.5a6 6 0 016 6v1.5a6 6 0 01-6 6z" /></svg>
                    </div>
                    <h3 class="font-semibold text-lg text-green-800">Natural Language Query</h3>
                    <p class="text-sm mt-1">Ask questions in conversational language via text or voice, removing literacy barriers.</p>
                </div>
                <!-- Feature 3: Market Intelligence -->
                <div class="p-6 bg-gray-50 rounded-lg">
                    <div class="feature-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V6.375m0 0A1.125 1.125 0 013.375 5.25h17.25c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-17.25a1.125 1.125 0 01-1.125-1.125v-9.75z" />
                        </svg>
                    </div>
                    <h3 class="font-semibold text-lg text-green-800">Market Intelligence</h3>
                    <p class="text-sm mt-1">Provides daily Mandi prices, MSP info, and demand forecasts to help farmers bypass middlemen.</p>
                </div>
                <!-- Feature 4: Context Aware -->
                <div class="p-6 bg-gray-50 rounded-lg">
                    <div class="feature-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" /></svg>
                    </div>
                    <h3 class="font-semibold text-lg text-green-800">Hyper-Local Context</h3>
                    <p class="text-sm mt-1">Factors in farmer's location, soil type, and season for personalized advice.</p>
                </div>
            </div>
        </section>

        <!-- System Architecture -->
        <section id="architecture" class="section-card">
            <h2>System Architecture & Workflow</h2>
            <p class="mb-12">The Agri-Connect platform is built on a modular, cloud-native architecture designed for scalability and real-time processing. The workflow below illustrates the journey of a farmer's query from input to resolution, highlighting the core AI processing and the seamless integration of human expertise when required.</p>
            
            <div class="relative">
                <!-- Center line -->
                <div class="hidden md:block absolute top-1/2 left-0 w-full h-0.5 bg-green-200" style="transform: translateY(-50%);"></div>

                <div class="relative flex flex-col md:flex-row justify-between items-center text-center space-y-8 md:space-y-0">
                    
                    <!-- Step 1: Input -->
                    <div class="flex flex-col items-center w-48">
                        <div class="relative z-10 flex items-center justify-center w-20 h-20 bg-green-500 text-white rounded-full border-4 border-white shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>
                        </div>
                        <div class="mt-4">
                            <h3 class="font-semibold text-green-800">1. Farmer Input</h3>
                            <p class="text-sm text-gray-600 mt-1">Query via Text, Voice, or Image through the mobile app.</p>
                        </div>
                    </div>
                    
                    <!-- Step 2: Processing -->
                    <div class="flex flex-col items-center w-48">
                        <div class="relative z-10 flex items-center justify-center w-20 h-20 bg-green-500 text-white rounded-full border-4 border-white shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2" /></svg>
                        </div>
                        <div class="mt-4">
                            <h3 class="font-semibold text-green-800">2. Pre-Processing</h3>
                            <p class="text-sm text-gray-600 mt-1">Data is cleaned. Speech is converted to text and images are analyzed.</p>
                        </div>
                    </div>

                    <!-- Step 3: AI Core -->
                    <div class="flex flex-col items-center w-48">
                        <div class="relative z-10 flex items-center justify-center w-20 h-20 bg-green-700 text-white rounded-full border-4 border-white shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 002.25-2.25V6.75a2.25 2.25 0 00-2.25-2.25H6.75A2.25 2.25 0 004.5 6.75v10.5a2.25 2.25 0 002.25 2.25z" /></svg>
                        </div>
                        <div class="mt-4">
                            <h3 class="font-semibold text-green-800">3. AI Core Engine</h3>
                            <p class="text-sm text-gray-600 mt-1">LLM enriches query with location, soil type, and market data to find the best answer.</p>
                        </div>
                    </div>

                    <!-- Step 4: Output -->
                    <div class="flex flex-col items-center w-48">
                        <div class="relative z-10 flex items-center justify-center w-20 h-20 bg-green-500 text-white rounded-full border-4 border-white shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg>
                        </div>
                        <div class="mt-4">
                            <h3 class="font-semibold text-green-800">4. Actionable Advice</h3>
                            <p class="text-sm text-gray-600 mt-1">A clear, concise answer is sent to the farmer's app in their native language.</p>
                        </div>
                    </div>
                </div>
                <!-- Escalation Path -->
                <div class="mt-12 flex justify-center">
                    <div class="flex flex-col items-center text-center w-64 p-4 border-2 border-dashed border-yellow-400 bg-yellow-50 rounded-lg">
                         <div class="flex items-center justify-center w-12 h-12 bg-yellow-400 text-white rounded-full shadow-md">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                        </div>
                        <h3 class="font-semibold text-yellow-800 mt-3">Human Escalation</h3>
                        <p class="text-sm text-yellow-700 mt-1">If the AI's confidence is low, the entire case is seamlessly forwarded to a local agricultural expert for review.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Expected Impact -->
        <section id="impact" class="section-card">
            <h2>Expected Impact & Data-Driven Projections</h2>
            <p class="mb-8">Agri-Connect is designed to deliver tangible benefits. By providing direct access to tailored information and market data, the platform will not only improve agricultural practices but also significantly boost farmer income. The following data points and projections quantify the expected impact.</p>

            <!-- KPI Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center mb-12">
                <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                    <div class="text-5xl text-green-600 font-bold">15%</div>
                    <p class="mt-2 text-gray-600 font-semibold">Projected Increase in Crop Yield</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                    <div class="text-5xl text-green-600 font-bold">20%</div>
                    <p class="mt-2 text-gray-600 font-semibold">Potential Increase in Farmer Income</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                    <div class="text-5xl text-blue-600 font-bold">50%</div>
                    <p class="mt-2 text-gray-600 font-semibold">Faster Access to Govt. Subsidies</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                    <div class="text-5xl text-red-500 font-bold">25%</div>
                    <p class="mt-2 text-gray-600 font-semibold">Reduction in Pesticide Use</p>
                </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div class="kpi-card">
                    <h3 class="text-lg font-semibold text-green-800 mb-2">Query Resolution Time Analysis</h3>
                    <p class="text-sm mb-4">Drastic reduction in average time taken to get a trusted answer for a critical query.</p>
                    <canvas id="resolutionTimeChart"></canvas>
                </div>
                <div class="kpi-card">
                    <h3 class="text-lg font-semibold text-green-800 mb-2">Farmer Profitability Analysis</h3>
                    <p class="text-sm mb-4">Projected income per hectare with and without Agri-Connect market linkage.</p>
                    <canvas id="profitabilityBarChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Agri-Connect Live Demo -->
        <section id="live-demo" class="section-card">
            <h2 class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c.252 0 .504 0 .752.011a2.25 2.25 0 012.248 2.248v5.714a2.25 2.25 0 01-.659 1.591L14.25 14.5M9.75 3.104a2.25 2.25 0 00-2.25 2.25v5.714a2.25 2.25 0 00.659 1.591L9.75 14.5m0-11.396c.252 0 .504 0 .752.011a2.25 2.25 0 002.248-2.248M14.25 14.5c.621 0 1.125-.504 1.125-1.125V6.104a2.25 2.25 0 00-2.248-2.248c-.248.01-.499.01-.752.01M14.25 14.5L9.75 21m0 0l-4.5-6.5m4.5 6.5l4.5-6.5" />
                </svg>
                Agri-Connect: Live Demo ✨
            </h2>
            <p class="mb-6 text-gray-600">Experience the power of Agri-Connect firsthand. Ask a question about farming in Rajasthan and get an instant, AI-generated recommendation. This demo uses the Gemini API with Google Search grounding to provide the most relevant and up-to-date information possible.</p>
            
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                <div class="mb-4">
                    <label for="queryInput" class="block text-sm font-medium text-gray-700 mb-2">Ask your question:</label>
                    <textarea id="queryInput" rows="4" class="w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition" placeholder="e.g., What is the best time to plant mustard in Ajmer? or मेरे कपास के पत्तों में छेद क्यों हैं?"></textarea>
                </div>
                <div class="mb-4 text-sm">
                    <span class="font-medium">Or try an example:</span>
                    <button class="example-query-btn text-green-700 hover:underline ml-2" data-query="What are the current government subsidies for drip irrigation in Rajasthan?">Drip irrigation subsidies?</button>
                    <button class="example-query-btn text-green-700 hover:underline ml-2" data-query="Best pest control for whitefly on cotton plants?">Whitefly on cotton?</button>
                </div>
                <div class="flex items-center">
                    <button id="submitQueryBtn" class="bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition disabled:bg-gray-400">
                        ✨ Get AI Advice
                    </button>
                    <div id="loadingSpinner" class="ml-4" style="display: none;">
                        <svg class="animate-spin h-5 w-5 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="mt-6">
                <h3 class="text-lg font-semibold text-green-800 mb-2">AI Response:</h3>
                <div id="aiResponse" class="p-6 bg-green-50 border-l-4 border-green-500 rounded-r-lg min-h-[100px] text-gray-700 leading-relaxed whitespace-pre-wrap">
                    Your AI-powered advice will appear here...
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-green-900 text-green-200 mt-8">
        <div class="container mx-auto px-6 py-4 text-center">
            <p>&copy; 2024 Agri-Connect Project. All Rights Reserved.</p>
            <p class="text-sm text-green-300">A Farmer-First Initiative</p>
        </div>
    </footer>

    <script>
        // Chart.js Configuration
        document.addEventListener('DOMContentLoaded', function () {
            // 1. Pie Chart for Farmer Queries
            const queryPieCtx = document.getElementById('queryPieChart').getContext('2d');
            new Chart(queryPieCtx, {
                type: 'pie',
                data: {
                    labels: ['Market Linkage & Prices', 'Crop & Soil Advisory', 'Pest & Disease', 'Govt. Schemes', 'Weather', 'Other'],
                    datasets: [{
                        label: 'Query Distribution',
                        data: [35, 25, 15, 10, 10, 5],
                        backgroundColor: ['#14532d', '#166534', '#15803d', '#16a34a', '#22c55e', '#4ade80'],
                        hoverOffset: 4
                    }]
                },
                options: { responsive: true, plugins: { legend: { position: 'top' } } }
            });

            // 2. Bar Chart for Cost of Delay
            const costOfDelayCtx = document.getElementById('costOfDelayChart').getContext('2d');
            new Chart(costOfDelayCtx, {
                type: 'bar',
                data: {
                    labels: ['Pest Attack', 'Sowing Time Query', 'Subsidy Info Delay'],
                    datasets: [{
                        label: 'Potential Loss per Day (₹)',
                        data: [5500, 3000, 2000],
                        backgroundColor: '#dc2626',
                        borderColor: '#b91c1c',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: { y: { beginAtZero: true } },
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // 3. Horizontal Bar Chart for Resolution Time
            const resolutionTimeCtx = document.getElementById('resolutionTimeChart').getContext('2d');
            new Chart(resolutionTimeCtx, {
                type: 'bar',
                data: {
                    labels: ['Traditional Methods', 'Agri-Connect'],
                    datasets: [{
                        label: 'Avg. Resolution Time (Minutes)',
                        data: [720, 5], // 12 hours vs 5 minutes
                        backgroundColor: ['#f59e0b', '#16a34a'],
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    scales: { x: { beginAtZero: true } },
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // 4. Bar Chart for Profitability
            const profitabilityBarCtx = document.getElementById('profitabilityBarChart').getContext('2d');
            new Chart(profitabilityBarCtx, {
                type: 'bar',
                data: {
                    labels: ['Wheat', 'Mustard', 'Cotton'],
                    datasets: [{
                        label: 'Income without Agri-Connect (₹)',
                        data: [45000, 48000, 65000],
                        backgroundColor: '#a7f3d0',
                        borderWidth: 1
                    }, {
                        label: 'Income with Agri-Connect (₹)',
                        data: [54000, 58000, 78000],
                        backgroundColor: '#16a34a',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: function(value) { return '₹' + value / 1000 + 'k'; } }
                        }
                    },
                    responsive: true,
                    plugins: { legend: { position: 'top' } }
                }
            });
        });

        // --- Gemini API Integration ---
        const queryInput = document.getElementById('queryInput');
        const submitBtn = document.getElementById('submitQueryBtn');
        const responseContainer = document.getElementById('aiResponse');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const exampleButtons = document.querySelectorAll('.example-query-btn');

        submitBtn.addEventListener('click', generateAdvice);

        exampleButtons.forEach(button => {
            button.addEventListener('click', () => {
                queryInput.value = button.getAttribute('data-query');
                queryInput.focus();
            });
        });

        async function generateAdvice() {
            const userQuery = queryInput.value.trim();
            if (!userQuery) {
                responseContainer.innerText = 'Please enter a question.';
                return;
            }

            submitBtn.disabled = true;
            loadingSpinner.style.display = 'block';
            responseContainer.innerHTML = 'Thinking...';

            const systemPrompt = "You are Agri-Connect, an expert AI assistant for farmers in Rajasthan, India. Provide clear, concise, and actionable advice in simple, easy-to-understand language. If the query is in Hindi, respond in Hindi. Your knowledge base includes local crop calendars for Rajasthan, pest advisories, weather patterns, and Indian government scheme guidelines. Always consider the current date and the location as Rajasthan to give hyper-local advice. Start your response with a friendly greeting and format key points using markdown (e.g., **bolding** and * lists).";

            const apiKey = ""; // API key is handled by the execution environment.
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                tools: [{ "google_search": {} }], // Enable grounding for real-time info
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            try {
                const response = await fetchWithExponentialBackoff(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    throw new Error(`API error: ${response.statusText}`);
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];
                
                if (candidate && candidate.content?.parts?.[0]?.text) {
                    let text = candidate.content.parts[0].text;
                    // Simple markdown to HTML conversion for lists and bolding
                    let htmlText = text
                        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                        .replace(/^\s*\*\s+(.*$)/gm, '<li class="ml-4 list-disc">$1</li>');
                    htmlText = htmlText.replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>').replace(/\n/g, '<br>');
                    responseContainer.innerHTML = htmlText;
                } else {
                    responseContainer.innerText = 'Sorry, I could not generate a response. The model may have returned an empty answer. Please try rephrasing your question.';
                    console.error('Unexpected API response structure:', result);
                }

            } catch (error) {
                responseContainer.innerText = 'An error occurred while fetching advice. Please check your connection and try again.';
                console.error('Error calling Gemini API:', error);
            } finally {
                submitBtn.disabled = false;
                loadingSpinner.style.display = 'none';
            }
        }

        // Exponential backoff function to handle rate limiting
        async function fetchWithExponentialBackoff(url, options, retries = 3, backoff = 1000) {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, options);
                    // Check for rate-limiting status code
                    if (response.status === 429) {
                         throw new Error('Rate limited');
                    }
                    if (!response.ok) {
                        console.warn(`Attempt ${i + 1} failed with status: ${response.status}`);
                    } else {
                        return response;
                    }
                } catch (error) {
                    if (i === retries - 1) throw error;
                    const delay = backoff * Math.pow(2, i) + Math.random() * 100; // Add jitter
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
            throw new Error('Max retries reached');
        }

    </script>

</body>
</html>

